### 1. 造一个小 CSV文件 (照抄 D2L)
```python
import os
import pandas as pd
import torch

os.makedirs(os.path.join("..", "data"), exist_ok = True)
data_file = os.path.join("..", "data", "house_tiny.csv")

with open(data_file, "w") as f:
    f.write("NumRooms,Alley,Price\n")
    f.write("NA,Pave,127500\n")
    f.write("2,NA,106000\n")
    f.write("4,NA,178100\n")
    f.write("NA,NA,140000\n")

# 比书中多了一个 na_values  主要是因为我发现 NA 没被看成缺失值(悲)
data = pd.read_csv(data_file, na_values = ["NA"])
data
````

---
### 2. 切分 inputs / targets(特征 / 标签)

```python
# 提取 NumRooms 和 Alley
inputs = data.iloc[:, 0:2]
# 提取 Price
targets = data.iloc[:, 2]
```

---
### 3. 处理缺失 + 类别特征 (one-hot)

`dummy_na = True` 会把缺失值也当成一种类别，否则缺失可能丢失信息

```python
# 把类别列(RoofType)变成 one-hot (非0即1)
# dummy_na=True: 缺失也出一列 Alley_nan
inputs = pd.get_dummies(inputs, dummy_na = True)
inputs
```

---
### 4. 数值缺失填补(用均值)

```python
# 对数值列的 NaN, 用该列均值填补
inputs = inputs.fillna(inputs.mean())
inputs
```

---

### 5. 转成 Tensor 建议统一 float32 (因为训练快)

```python
# 书上的inputs.value我是死活运行不起来
# 没想到是改名字叫to_numpy()变成方法了
# 写法不一定符合所有人习惯 请自适应(笑)
X = torch.tensor(inputs.to_numpy(dtype=float), dtype=torch.float32)
Y = torch.tensor(targets.to_numpy(dtype=float), dtype=torch.float32)

X.shape, Y.shape
```
